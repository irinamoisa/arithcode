<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ArithmeticCoding: Arithmetic Coding</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ArithmeticCoding
   &#160;<span id="projectnumber">0.0.0a</span>
   </div>
   <div id="projectbrief">Arithmetic coding in C</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Arithmetic Coding </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="Contents"></a>
Contents</h2>
<ul>
<li><a class="el" href="index.html#Example">Example</a></li>
<li><a class="el" href="index.html#Features">Features</a></li>
<li><a class="el" href="index.html#History">History and Caveats</a></li>
<li><a class="el" href="index.html#CDFs">Cumulative Distribution Functions (CDFs)</a></li>
<li><a class="el" href="index.html#Encoding">Encoding Functions</a></li>
<li><a class="el" href="index.html#Decoding">Decoding functions</a></li>
</ul>
<h2><a class="anchor" id="Example"></a>
Example</h2>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> encode()
    { <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, *output=0;      <span class="comment">// input and output buffer</span>
      <span class="keywordtype">size_t</span> countof_input, countof_output; <span class="comment">// number of symbols in input and output buffer</span>
      <span class="keywordtype">float</span> *cdf=0;
      <span class="keywordtype">size_t</span> nsym;                          <span class="comment">// number of symbols in the input alphabet</span>
      <span class="comment">// somehow load the data into input array</span>
      <a class="code" href="group___arithmetic_coding.html#ga9f40c1d129b27b1cdfa4d4e6dc9c2ee5" title="Build a cumulative distribution function (CDF) from an input u32 array.">cdf_build</a>(&amp;cdf,&amp;nsym,input,countof_input);
      <a class="code" href="group___encoding.html#ga98e1eefec1e84adfe3ce84e17d7eae86">encode_u1_u8</a>(                         <span class="comment">// encode unsigned chars to a string of bits (1 bit per output symbol)</span>
        (<span class="keywordtype">void</span>**)&amp;out,&amp;countof_output,
               input, countof_input,
                 cdf, nsym);
      <span class="comment">// do something with the output</span>
      free(out);
      free(cdf);
    }
</pre></div><h2><a class="anchor" id="Features"></a>
Features</h2>
<ul>
<li>Encoding/decoding to/from variable symbol alphabets.</li>
</ul>
<ul>
<li>Implicit use of a STOP symbol means that you don't need to know the number of symbols in the decoded message in order to decode something.</li>
</ul>
<ul>
<li>Can encoded messages stored as signed or unsigned chars, shorts, longs or long longs. Keep in mind, however, that the number of encodable symbols may be limiting. You can't encode 2^64 different integers, sorry.</li>
</ul>
<ul>
<li>Can encode to streams of variable symbol width; either 1,4,8, or 16 bits. There is are two tradeoffs here.</li>
</ul>
<ul>
<li>Smaller bit-width (e.g. 1) give better compression than larger bit-width (e.g. 16), but compression is slower (I think?).</li>
</ul>
<ul>
<li>The implimentation puts a limit on the smallest probability of an encoded symbol. Smaller bit-width (e.g. 1) can accomidate a larger range of probabilities than large bit-width (e.g. 16).</li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Markov chain adaptive encoding/decoding.</dd></dl>
<h2><a class="anchor" id="History"></a>
History and Caveats</h2>
<p>I wrote this in order to learn about arithmetic coding. The end goal was to get to the point where I had an adaptive encoder/decoder that could compress markov chains. I got a little distracted along the way by trying to encode to a variable symbol alphabet. Variable symbol encoding alphabets are fun because you can encode to non-whitespace ASCII characters (94 symbols) and that means the encoded message can be embeded in a text file format.</p>
<p>Arithmetic coding is a computationally expensive coding method. I've done nothing to address this problem; I've probably made it worse.</p>
<p>To learn more about arithmetic coding see this excelent reference: </p>
<div class="fragment"><pre class="fragment">
    Said, A. “Introduction to Arithmetic Coding - Theory and Practice.” 
         Hewlett Packard Laboratories Report: 2004–2076.
         www.hpl.hp.com/techreports/2004/HPL-2004-76.pdf
   </pre></div><h2><a class="anchor" id="CDFs"></a>
Cumulative Distribution Functions (CDFs)</h2>
<p>All the encoding and decoding functions require knowledge of the probability of observing input symbols. This probability is specified as a CDF of a particular form. Namely:</p>
<p>1. <code>cdf</code>[0] must be zero (0.0).</p>
<p>2. The probability density for symbol <em>i</em> should be <code>cdf</code>[i+1]-cdf[i].</p>
<p>This implies, for an alphabet with <em>M</em> symbols:</p>
<ul>
<li><em>cdf</em> has <em>M+1</em> elements.</li>
</ul>
<ul>
<li><code>cdf</code>[M] is 1.0 (within floating point precision)</li>
</ul>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___arithmetic_coding.html#ga9f40c1d129b27b1cdfa4d4e6dc9c2ee5" title="Build a cumulative distribution function (CDF) from an input u32 array.">cdf_build()</a> for an example of how to build a CDF from a given input message.</dd></dl>
<h2><a class="anchor" id="Encoding"></a>
Encoding Functions</h2>
<p>Encoding functions all have the same form: </p>
<div class="fragment"><pre class="fragment">    encode_&lt;TDst&gt;_&lt;TSrc&gt;(<span class="keywordtype">void</span> **out, <span class="keywordtype">size_t</span> *nout, uint8_t *in, <span class="keywordtype">size_t</span> nin, <span class="keywordtype">float</span> *cdf, <span class="keywordtype">size_t</span> nsym);
</pre></div><p> where <em>TDst</em> and <em>TSrc</em> are the output and input types, respectively. The output buffer, <em>*out</em>, can be an heap-allocated buffer; it's capacity in bytes should be passed as <em>*nout</em>. If <em>*out</em> is not large enough (or NULL), it will be reallocated. The new capacity will be returned in <em>*nout</em>.</p>
<ul>
<li><a class="el" href="group___encoding.html#ga98e1eefec1e84adfe3ce84e17d7eae86">encode_u1_u8()</a></li>
<li><a class="el" href="group___encoding.html#ga0caa0be566ef1cae1c35d9a89789cacc">encode_u4_u8()</a></li>
<li><a class="el" href="group___encoding.html#ga9e33188e0d3ba3ccac09dbb4cb55b9f6">encode_u8_u8()</a></li>
<li><a class="el" href="group___encoding.html#ga792ef59ff9004a1b0c24fd3b25b317c4">encode_u1_u16()</a></li>
<li><a class="el" href="group___encoding.html#gab0b10ef3b60464cc596ca209db87afc2">encode_u4_u16()</a></li>
<li><a class="el" href="group___encoding.html#ga3cc8b1c867285ac43f94edfacc7b4634">encode_u8_u16()</a></li>
<li><a class="el" href="group___encoding.html#ga70597498e8c7c9abeb47df2570e29474">encode_u1_u32()</a></li>
<li><a class="el" href="group___encoding.html#ga7ae5711970de13164db7ba8a343cb60f">encode_u4_u32()</a></li>
<li><a class="el" href="group___encoding.html#gaa5d0217a1fc700083b9c461177dc867f">encode_u8_u32()</a></li>
<li><a class="el" href="group___encoding.html#ga530dbd98cd2b3f685db0460434ce42e0">encode_u1_u64()</a></li>
<li><a class="el" href="group___encoding.html#gade38ce1808677079c28416271b4da951">encode_u4_u64()</a></li>
<li><a class="el" href="group___encoding.html#ga1d060d4c7f7e5c2eebbad2430d4b5567">encode_u8_u64()</a></li>
</ul>
<p>Variable symbol encodings are a little different. These functions take the number of output symbols, <em>noutsym</em>, as well. They always encode to a 1-byte stream. Their form is: </p>
<div class="fragment"><pre class="fragment">    vencode_&lt;TSrc&gt;(<span class="keywordtype">void</span> **out, <span class="keywordtype">size_t</span> *nout, <span class="keywordtype">size_t</span> noutsym, uint8_t *in, <span class="keywordtype">size_t</span> nin, <span class="keywordtype">size_t</span> ninsym, <span class="keywordtype">float</span> *cdf);
</pre></div><ul>
<li><a class="el" href="group___variable.html#gac1b0f76cd269888814de5911b2b705d0">vencode_u8()</a></li>
<li><a class="el" href="group___variable.html#gad885efd315cfd72ff9b3add7d24c40ee">vencode_u16()</a></li>
<li><a class="el" href="group___variable.html#gac3405bec1a1cd1b474be9aa8ecda6531">vencode_u32()</a></li>
<li><a class="el" href="group___variable.html#gafd68ad871eaadfa3736de34fff79abc7">vencode_u64()</a></li>
</ul>
<h2><a class="anchor" id="Decoding"></a>
Decoding functions</h2>
<p>Decoding functions all have the same form: </p>
<div class="fragment"><pre class="fragment">    decode_&lt;TDst&gt;_&lt;TSrc&gt;(<span class="keywordtype">void</span> **out, <span class="keywordtype">size_t</span> *nout, uint8_t *in, <span class="keywordtype">size_t</span> nin, <span class="keywordtype">float</span> *cdf, <span class="keywordtype">size_t</span> nsym);
</pre></div><p> where <em>TDst</em> and <em>TSrc</em> are the output and input types, respectively. The output buffer, <em>*out</em>, can be an heap-allocated buffer; it's capacity in bytes should be passed as <em>*nout</em>. If <em>*out</em> is not large enough (or NULL), it will be reallocated. The new capacity will be returned in <em>*nout</em>.</p>
<p>This is basically identical to the encode functions, but here "output" refers to the decoded message and "input" refers to an encoded message.</p>
<ul>
<li><a class="el" href="group___decoding.html#ga0da8fbf54b90f7c190b9b67716d8897c">decode_u8_u1()</a></li>
<li><a class="el" href="group___decoding.html#ga531919be13a01da461d5ab723c66628a">decode_u8_u4()</a></li>
<li><a class="el" href="group___decoding.html#ga8f257070c54456ca66aeda62dcf16876">decode_u8_u8()</a></li>
<li><a class="el" href="group___decoding.html#gaf85492c5909edae7a68c19d2c124b827">decode_u16_u1()</a></li>
<li><a class="el" href="group___decoding.html#ga2fbc57bf3199d28c49ecf14f3274179f">decode_u16_u4()</a></li>
<li><a class="el" href="group___decoding.html#ga9bef6684b77bbdc7ff87755ff0536eed">decode_u16_u8()</a></li>
<li><a class="el" href="group___decoding.html#ga2d0f20e9affcb627be7748fd1f36be0d">decode_u32_u1()</a></li>
<li><a class="el" href="group___decoding.html#ga5f02853f65c7e6cf0a53953f2baf6ce9">decode_u32_u4()</a></li>
<li><a class="el" href="group___decoding.html#ga71f1c384a2974ce75bd3839d8f9f3053">decode_u32_u8()</a></li>
<li><a class="el" href="group___decoding.html#ga389085c6ef9b147db56d6ab183e1fc12">decode_u64_u1()</a></li>
<li><a class="el" href="group___decoding.html#gae72104a3c36588cb3388968e618beb18">decode_u64_u4()</a></li>
<li><a class="el" href="group___decoding.html#ga9c9b2ddfca1cf943c974cb73a012eb25">decode_u64_u8()</a></li>
</ul>
<p>Variable symbol decoding has the form: </p>
<div class="fragment"><pre class="fragment">    vdecode_&lt;TDst&gt;(<span class="keywordtype">void</span> **out, <span class="keywordtype">size_t</span> *nout, <span class="keywordtype">size_t</span> noutsym, uint8_t *in, <span class="keywordtype">size_t</span> nin, <span class="keywordtype">size_t</span> ninsym, <span class="keywordtype">float</span> *cdf);
</pre></div><ul>
<li><a class="el" href="group___variable.html#ga7b8dcb37c3e04cd7dec1d7e360ce9524">vdecode_u8()</a></li>
<li><a class="el" href="group___variable.html#ga21d677ceb4fcd43a68e3cf1299f4f801">vdecode_u16()</a></li>
<li><a class="el" href="group___variable.html#ga27cf2145bf65254af9022789343bf6fd">vdecode_u32()</a></li>
<li><a class="el" href="group___variable.html#gabf8d346bbb4a0d77475435122c296b4f">vdecode_u64()</a></li>
</ul>
<dl class="author"><dt><b>Author:</b></dt><dd>Nathan Clack &lt;<a href="https://github.com/nclack">https://github.com/nclack</a>&gt; </dd></dl>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 23 2012 17:58:46 for ArithmeticCoding by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
